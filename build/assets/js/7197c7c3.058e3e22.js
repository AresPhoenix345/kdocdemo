"use strict";(globalThis.webpackChunkkubestellar_docs_initiative=globalThis.webpackChunkkubestellar_docs_initiative||[]).push([[3139],{6361(e,n,s){s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>l,toc:()=>a});const l=JSON.parse('{"id":"quickstart/first-deployment","title":"First Deployment","description":"Congratulations! You\'ve installed KubeStellar. Now let\'s deploy your first application across multiple clusters using a BindingPolicy.","source":"@site/docs/quickstart/first-deployment.md","sourceDirName":"quickstart","slug":"/quickstart/first-deployment","permalink":"/docs/quickstart/first-deployment","draft":false,"unlisted":false,"editUrl":"https://github.com/kubestellar/kubestellar/edit/main/kdemo/docs/quickstart/first-deployment.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Installation","permalink":"/docs/quickstart/installation"},"next":{"title":"Tutorials","permalink":"/docs/tutorials/"}}');var t=s(4848),r=s(8453);const i={},c="First Deployment",o={},a=[{value:"Overview",id:"overview",level:2},{value:"Step 1: Switch to WDS Context",id:"step-1-switch-to-wds-context",level:2},{value:"Step 2: Create a Namespace",id:"step-2-create-a-namespace",level:2},{value:"Step 3: Create a Deployment",id:"step-3-create-a-deployment",level:2},{value:"Step 4: Create a BindingPolicy",id:"step-4-create-a-bindingpolicy",level:2},{value:"Step 5: Check Binding Status",id:"step-5-check-binding-status",level:2},{value:"Step 6: Verify Deployment on WECs",id:"step-6-verify-deployment-on-wecs",level:2},{value:"Check cluster1",id:"check-cluster1",level:3},{value:"Check cluster2",id:"check-cluster2",level:3},{value:"Step 7: Verify Workload Status",id:"step-7-verify-workload-status",level:2},{value:"Understanding What Happened",id:"understanding-what-happened",level:2},{value:"Step 8: Test Updates",id:"step-8-test-updates",level:2},{value:"Step 9: Selective Deployment",id:"step-9-selective-deployment",level:2},{value:"Cleanup",id:"cleanup",level:2},{value:"Key Takeaways",id:"key-takeaways",level:2},{value:"Common Patterns",id:"common-patterns",level:2},{value:"Deploy to All Clusters",id:"deploy-to-all-clusters",level:3},{value:"Deploy to Specific Cluster",id:"deploy-to-specific-cluster",level:3},{value:"Deploy Multiple Workloads",id:"deploy-multiple-workloads",level:3},{value:"Next Steps",id:"next-steps",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Deployment Not Appearing on WECs",id:"deployment-not-appearing-on-wecs",level:3},{value:"Status Not Updating",id:"status-not-updating",level:3}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"first-deployment",children:"First Deployment"})}),"\n",(0,t.jsx)(n.p,{children:"Congratulations! You've installed KubeStellar. Now let's deploy your first application across multiple clusters using a BindingPolicy."}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(n.p,{children:"In this guide, you will:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Create a simple nginx deployment"}),"\n",(0,t.jsx)(n.li,{children:"Create a BindingPolicy to control where it runs"}),"\n",(0,t.jsx)(n.li,{children:"Verify the deployment across clusters"}),"\n",(0,t.jsx)(n.li,{children:"Understand how KubeStellar synchronizes workloads"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Estimated Time: 10 minutes"})}),"\n",(0,t.jsx)(n.h2,{id:"step-1-switch-to-wds-context",children:"Step 1: Switch to WDS Context"}),"\n",(0,t.jsx)(n.p,{children:"All workload definitions go into the WDS:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kubectl config use-context wds1\n"})}),"\n",(0,t.jsx)(n.h2,{id:"step-2-create-a-namespace",children:"Step 2: Create a Namespace"}),"\n",(0,t.jsx)(n.p,{children:"Create a namespace for your application:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kubectl create namespace demo\r\nkubectl config set-context --current --namespace=demo\n"})}),"\n",(0,t.jsx)(n.h2,{id:"step-3-create-a-deployment",children:"Step 3: Create a Deployment"}),"\n",(0,t.jsx)(n.p,{children:"Create a simple nginx deployment:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cat <<EOF | kubectl apply -f -\r\napiVersion: apps/v1\r\nkind: Deployment\r\nmetadata:\r\n  name: nginx\r\n  namespace: demo\r\n  labels:\r\n    app.kubernetes.io/name: nginx\r\nspec:\r\n  replicas: 2\r\n  selector:\r\n    matchLabels:\r\n      app.kubernetes.io/name: nginx\r\n  template:\r\n    metadata:\r\n      labels:\r\n        app.kubernetes.io/name: nginx\r\n    spec:\r\n      containers:\r\n      - name: nginx\r\n        image: nginx:1.25\r\n        ports:\r\n        - containerPort: 80\r\nEOF\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Verify in WDS:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kubectl get deployments -n demo\r\n# Should show: nginx deployment\n"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Important"}),": This deployment exists only in the WDS. It won't run until we create a BindingPolicy."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"step-4-create-a-bindingpolicy",children:"Step 4: Create a BindingPolicy"}),"\n",(0,t.jsx)(n.p,{children:"A BindingPolicy tells KubeStellar which workloads should go to which clusters:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cat <<EOF | kubectl apply -f -\r\napiVersion: control.kubestellar.io/v1alpha1\r\nkind: BindingPolicy\r\nmetadata:\r\n  name: nginx-policy\r\n  namespace: demo\r\nspec:\r\n  clusterSelectors:\r\n  - matchLabels:\r\n      location-group: edge\r\n  downsync:\r\n  - objectSelectors:\r\n    - matchLabels:\r\n        app.kubernetes.io/name: nginx\r\n    resources:\r\n    - namespaces\r\n    - deployments\r\nEOF\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"What this does:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"clusterSelectors"}),": Targets clusters with label ",(0,t.jsx)(n.code,{children:"location-group=edge"})," (both cluster1 and cluster2)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"downsync"}),": Synchronizes nginx deployments and namespaces to those clusters"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Verify BindingPolicy:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kubectl get bindingpolicies -n demo\r\nkubectl describe bindingpolicy nginx-policy -n demo\n"})}),"\n",(0,t.jsx)(n.h2,{id:"step-5-check-binding-status",children:"Step 5: Check Binding Status"}),"\n",(0,t.jsxs)(n.p,{children:["KubeStellar creates a ",(0,t.jsx)(n.code,{children:"Binding"})," object that shows which workloads matched:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kubectl get bindings -n demo\r\nkubectl describe binding nginx-policy -n demo\n"})}),"\n",(0,t.jsx)(n.p,{children:"The Binding shows:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Which clusters matched (",(0,t.jsx)(n.code,{children:"clusterSelectors"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:["Which objects matched (",(0,t.jsx)(n.code,{children:"objectSelectors"}),")"]}),"\n",(0,t.jsx)(n.li,{children:"Sync status"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"step-6-verify-deployment-on-wecs",children:"Step 6: Verify Deployment on WECs"}),"\n",(0,t.jsx)(n.p,{children:"Wait a few seconds for synchronization, then check your WECs:"}),"\n",(0,t.jsx)(n.h3,{id:"check-cluster1",children:"Check cluster1"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kubectl config use-context cluster1\r\nkubectl get namespaces | grep demo\r\nkubectl get deployments -n demo\r\nkubectl get pods -n demo\n"})}),"\n",(0,t.jsx)(n.p,{children:"You should see:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"demo"})," namespace"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"nginx"})," deployment"]}),"\n",(0,t.jsx)(n.li,{children:"2 nginx pods running"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"check-cluster2",children:"Check cluster2"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kubectl config use-context cluster2\r\nkubectl get namespaces | grep demo\r\nkubectl get deployments -n demo\r\nkubectl get pods -n demo\n"})}),"\n",(0,t.jsx)(n.p,{children:"Same result - the deployment is synchronized to both clusters!"}),"\n",(0,t.jsx)(n.h2,{id:"step-7-verify-workload-status",children:"Step 7: Verify Workload Status"}),"\n",(0,t.jsx)(n.p,{children:"Switch back to WDS to see aggregated status:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kubectl config use-context wds1\r\nkubectl get deployments -n demo -o yaml\n"})}),"\n",(0,t.jsx)(n.p,{children:"The status section shows information from all clusters where the deployment is running."}),"\n",(0,t.jsx)(n.h2,{id:"understanding-what-happened",children:"Understanding What Happened"}),"\n",(0,t.jsx)(n.p,{children:"Here's the flow:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"WDS"}),": You created a Deployment object (standard Kubernetes format)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"BindingPolicy"}),": You defined which clusters should receive it"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"ITS"}),": Managed the transport of workloads to WECs"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"WECs"}),": Received and executed the workloads"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["The key insight: ",(0,t.jsx)(n.strong,{children:"You defined workloads once in the WDS, and KubeStellar synchronized them to multiple clusters automatically."})]}),"\n",(0,t.jsx)(n.h2,{id:"step-8-test-updates",children:"Step 8: Test Updates"}),"\n",(0,t.jsx)(n.p,{children:"Let's update the deployment and see it propagate:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kubectl config use-context wds1\r\nkubectl set image deployment/nginx nginx=nginx:1.26 -n demo\n"})}),"\n",(0,t.jsx)(n.p,{children:"Wait a few seconds, then check both clusters:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kubectl config use-context cluster1\r\nkubectl get pods -n demo -o jsonpath='{.items[0].spec.containers[0].image}'\r\n# Should show: nginx:1.26\r\n\r\nkubectl config use-context cluster2\r\nkubectl get pods -n demo -o jsonpath='{.items[0].spec.containers[0].image}'\r\n# Should show: nginx:1.26\n"})}),"\n",(0,t.jsx)(n.p,{children:"Both clusters updated automatically! \ud83c\udf89"}),"\n",(0,t.jsx)(n.h2,{id:"step-9-selective-deployment",children:"Step 9: Selective Deployment"}),"\n",(0,t.jsx)(n.p,{children:"Let's deploy to only one cluster. Update the BindingPolicy:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kubectl config use-context wds1\r\n\r\ncat <<EOF | kubectl apply -f -\r\napiVersion: control.kubestellar.io/v1alpha1\r\nkind: BindingPolicy\r\nmetadata:\r\n  name: nginx-policy\r\n  namespace: demo\r\nspec:\r\n  clusterSelectors:\r\n  - matchLabels:\r\n      environment: production\r\n  downsync:\r\n  - objectSelectors:\r\n    - matchLabels:\r\n        app.kubernetes.io/name: nginx\r\n    resources:\r\n    - namespaces\r\n    - deployments\r\nEOF\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Now only ",(0,t.jsx)(n.code,{children:"cluster1"})," (labeled ",(0,t.jsx)(n.code,{children:"environment=production"}),") will have the deployment:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kubectl config use-context cluster1\r\nkubectl get pods -n demo\r\n# Should show pods\r\n\r\nkubectl config use-context cluster2\r\nkubectl get pods -n demo\r\n# Should show: No resources found (deployment removed)\n"})}),"\n",(0,t.jsx)(n.h2,{id:"cleanup",children:"Cleanup"}),"\n",(0,t.jsx)(n.p,{children:"To clean up this demo:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Delete from WDS (this will remove from all clusters)\r\nkubectl config use-context wds1\r\nkubectl delete namespace demo\r\n\r\n# Or delete BindingPolicy first, then deployment\r\nkubectl delete bindingpolicy nginx-policy -n demo\r\nkubectl delete deployment nginx -n demo\n"})}),"\n",(0,t.jsx)(n.h2,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Workloads are defined in WDS"})," - Use standard Kubernetes objects"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"BindingPolicies control placement"})," - Use label selectors for clusters and workloads"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Automatic synchronization"})," - Changes in WDS propagate to WECs automatically"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Status aggregation"})," - View status from all clusters in one place"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"common-patterns",children:"Common Patterns"}),"\n",(0,t.jsx)(n.h3,{id:"deploy-to-all-clusters",children:"Deploy to All Clusters"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"spec:\r\n  clusterSelectors:\r\n  - {}  # Empty selector matches all clusters\n"})}),"\n",(0,t.jsx)(n.h3,{id:"deploy-to-specific-cluster",children:"Deploy to Specific Cluster"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"spec:\r\n  clusterSelectors:\r\n  - matchLabels:\r\n      cluster-name: production-us-east-1\n"})}),"\n",(0,t.jsx)(n.h3,{id:"deploy-multiple-workloads",children:"Deploy Multiple Workloads"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"spec:\r\n  downsync:\r\n  - objectSelectors:\r\n    - matchLabels:\r\n        app: frontend\r\n  - objectSelectors:\r\n    - matchLabels:\r\n        app: backend\n"})}),"\n",(0,t.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,t.jsx)(n.p,{children:"You've successfully deployed your first multi-cluster application! Now explore:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"/docs/tutorials/interactive-tutorial-preview",children:"Interactive Tutorial"})})," - Hands-on browser-based learning"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"/docs/tutorials/video-series-outline",children:"Video Series"})})," - Comprehensive video tutorials"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"/docs/use-cases/",children:"Use Cases"})})," - Real-world deployment patterns"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"/docs/architecture/overview",children:"Architecture Deep Dive"})})," - Understand how it all works"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,t.jsx)(n.h3,{id:"deployment-not-appearing-on-wecs",children:"Deployment Not Appearing on WECs"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Check BindingPolicy: ",(0,t.jsx)(n.code,{children:"kubectl get bindingpolicies -n demo"})]}),"\n",(0,t.jsxs)(n.li,{children:["Check Binding status: ",(0,t.jsx)(n.code,{children:"kubectl describe binding -n demo"})]}),"\n",(0,t.jsxs)(n.li,{children:["Verify cluster labels: ",(0,t.jsx)(n.code,{children:"kubectl get managedclusters --show-labels"})," (in ITS context)"]}),"\n",(0,t.jsxs)(n.li,{children:["Check ITS logs: ",(0,t.jsx)(n.code,{children:"kubectl logs -n kubeflex-system -l app=transport-controller"})]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"status-not-updating",children:"Status Not Updating"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Wait a few seconds for synchronization"}),"\n",(0,t.jsxs)(n.li,{children:["Check controller logs: ",(0,t.jsx)(n.code,{children:"kubectl logs -n kubeflex-system -l app=ks-controller-manager"})]}),"\n",(0,t.jsxs)(n.li,{children:["Verify WEC connectivity: ",(0,t.jsx)(n.code,{children:"kubectl get managedclusters"})," (in ITS context)"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Congratulations!"})," You've completed your first KubeStellar deployment! \ud83d\ude80"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453(e,n,s){s.d(n,{R:()=>i,x:()=>c});var l=s(6540);const t={},r=l.createContext(t);function i(e){const n=l.useContext(r);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),l.createElement(r.Provider,{value:n},e.children)}}}]);