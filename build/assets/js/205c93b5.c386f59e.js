"use strict";(globalThis.webpackChunkkubestellar_docs_initiative=globalThis.webpackChunkkubestellar_docs_initiative||[]).push([[3790],{805(e,n,s){s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>u,frontMatter:()=>i,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"quickstart/installation","title":"Installation","description":"This guide walks you through installing KubeStellar core components. We\'ll create a demo environment with one hosting cluster, one ITS, one WDS, and two WECs.","source":"@site/docs/quickstart/installation.md","sourceDirName":"quickstart","slug":"/quickstart/installation","permalink":"/docs/quickstart/installation","draft":false,"unlisted":false,"editUrl":"https://github.com/kubestellar/kubestellar/edit/main/kdemo/docs/quickstart/installation.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Prerequisites","permalink":"/docs/quickstart/prerequisites"},"next":{"title":"First Deployment","permalink":"/docs/quickstart/first-deployment"}}');var l=s(4848),r=s(8453);const i={},c="Installation",o={},a=[{value:"Overview",id:"overview",level:2},{value:"Step 1: Set KubeStellar Version",id:"step-1-set-kubestellar-version",level:2},{value:"Step 2: Create Hosting Cluster",id:"step-2-create-hosting-cluster",level:2},{value:"Option A: Using kind",id:"option-a-using-kind",level:3},{value:"Option B: Using k3d",id:"option-b-using-k3d",level:3},{value:"Step 3: Install KubeStellar Core Chart",id:"step-3-install-kubestellar-core-chart",level:2},{value:"Step 4: Configure Kubeconfig Contexts",id:"step-4-configure-kubeconfig-contexts",level:2},{value:"Step 5: Verify Installation",id:"step-5-verify-installation",level:2},{value:"Check ITS",id:"check-its",level:3},{value:"Check WDS",id:"check-wds",level:3},{value:"Check Controllers",id:"check-controllers",level:3},{value:"Step 6: Create WECs (Workload Execution Clusters)",id:"step-6-create-wecs-workload-execution-clusters",level:2},{value:"Using kind",id:"using-kind",level:3},{value:"Using k3d",id:"using-k3d",level:3},{value:"Step 7: Register WECs with ITS",id:"step-7-register-wecs-with-its",level:2},{value:"Step 8: Label WECs",id:"step-8-label-wecs",level:2},{value:"Installation Complete! \u2705",id:"installation-complete-",level:2},{value:"Set Shell Variables (Optional)",id:"set-shell-variables-optional",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Helm Chart Installation Fails",id:"helm-chart-installation-fails",level:3},{value:"Context Creation Fails",id:"context-creation-fails",level:3},{value:"WEC Registration Fails",id:"wec-registration-fails",level:3},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"installation",children:"Installation"})}),"\n",(0,l.jsx)(n.p,{children:"This guide walks you through installing KubeStellar core components. We'll create a demo environment with one hosting cluster, one ITS, one WDS, and two WECs."}),"\n",(0,l.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,l.jsx)(n.p,{children:"The installation process involves:"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Creating a hosting cluster (using kind or k3d)"}),"\n",(0,l.jsx)(n.li,{children:"Installing KubeFlex and KubeStellar controllers"}),"\n",(0,l.jsx)(n.li,{children:"Creating an ITS (Inventory and Transport Space)"}),"\n",(0,l.jsx)(n.li,{children:"Creating a WDS (Workload Description Space)"}),"\n",(0,l.jsx)(n.li,{children:"Setting up kubeconfig contexts"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Estimated Time: 10 minutes"})}),"\n",(0,l.jsx)(n.h2,{id:"step-1-set-kubestellar-version",children:"Step 1: Set KubeStellar Version"}),"\n",(0,l.jsx)(n.p,{children:"Set the version you want to install:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"export kubestellar_version=v0.27.1\n"})}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Note"}),": Replace ",(0,l.jsx)(n.code,{children:"v0.27.1"})," with the latest version from ",(0,l.jsx)(n.a,{href:"https://github.com/kubestellar/kubestellar/releases",children:"GitHub Releases"})]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"step-2-create-hosting-cluster",children:"Step 2: Create Hosting Cluster"}),"\n",(0,l.jsxs)(n.p,{children:["Choose either ",(0,l.jsx)(n.strong,{children:"kind"})," or ",(0,l.jsx)(n.strong,{children:"k3d"})," based on your preference."]}),"\n",(0,l.jsx)(n.h3,{id:"option-a-using-kind",children:"Option A: Using kind"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"bash <(curl -s https://raw.githubusercontent.com/kubestellar/kubestellar/${kubestellar_version}/scripts/create-kind-cluster-with-SSL-passthrough.sh) --name kubeflex --port 9443\n"})}),"\n",(0,l.jsx)(n.h3,{id:"option-b-using-k3d",children:"Option B: Using k3d"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'k3d cluster create kubeflex -p "9443:443@loadbalancer"\n'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Verify the cluster:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"kubectl cluster-info --context kind-kubeflex\r\n# or\r\nkubectl cluster-info --context k3d-kubeflex\n"})}),"\n",(0,l.jsx)(n.h2,{id:"step-3-install-kubestellar-core-chart",children:"Step 3: Install KubeStellar Core Chart"}),"\n",(0,l.jsx)(n.p,{children:"This single Helm command installs KubeFlex, creates the ITS and WDS, and sets up all controllers:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'helm upgrade --install ks-core oci://ghcr.io/kubestellar/kubestellar/core-chart \\\r\n    --version "$kubestellar_version" \\\r\n    --set-json ITSes=\'[{"name":"its1"}]\' \\\r\n    --set-json WDSes=\'[{"name":"wds1"}]\' \\\r\n    --set verbosity.default=5\n'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"What this does:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Installs KubeFlex operator"}),"\n",(0,l.jsxs)(n.li,{children:["Creates ITS named ",(0,l.jsx)(n.code,{children:"its1"})," (Inventory and Transport Space)"]}),"\n",(0,l.jsxs)(n.li,{children:["Creates WDS named ",(0,l.jsx)(n.code,{children:"wds1"})," (Workload Description Space)"]}),"\n",(0,l.jsx)(n.li,{children:"Deploys KubeStellar controller manager"}),"\n",(0,l.jsx)(n.li,{children:"Sets up OCM (Open Cluster Management) components"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Wait for installation to complete:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Watch the pods come up\r\nkubectl get pods -n kubeflex-system --watch\n"})}),"\n",(0,l.jsxs)(n.p,{children:["You should see pods in ",(0,l.jsx)(n.code,{children:"Running"})," state:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"kubeflex-controller-manager-*"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"ks-controller-manager-*"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"transport-controller-*"})}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"step-4-configure-kubeconfig-contexts",children:"Step 4: Configure Kubeconfig Contexts"}),"\n",(0,l.jsx)(n.p,{children:"Set up contexts for accessing your ITS and WDS:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Ensure you're using the hosting cluster context\r\nkubectl config use-context kind-kubeflex\r\n# or\r\nkubectl config use-context k3d-kubeflex\r\n\r\n# Set KubeFlex hosting context\r\nkflex ctx --set-current-for-hosting\r\n\r\n# Create context for ITS\r\nkflex ctx --overwrite-existing-context its1\r\n\r\n# Create context for WDS\r\nkflex ctx --overwrite-existing-context wds1\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Verify contexts:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"kubectl config get-contexts\n"})}),"\n",(0,l.jsx)(n.p,{children:"You should see:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"kind-kubeflex"})," (or ",(0,l.jsx)(n.code,{children:"k3d-kubeflex"}),") - hosting cluster"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"its1"})," - Inventory and Transport Space"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"wds1"})," - Workload Description Space"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"step-5-verify-installation",children:"Step 5: Verify Installation"}),"\n",(0,l.jsx)(n.h3,{id:"check-its",children:"Check ITS"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"kubectl config use-context its1\r\nkubectl get managedclusters\r\n# Should show: No resources found (no WECs registered yet)\n"})}),"\n",(0,l.jsx)(n.h3,{id:"check-wds",children:"Check WDS"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"kubectl config use-context wds1\r\nkubectl api-resources | grep kubestellar\r\n# Should show: bindingpolicies, bindings, etc.\n"})}),"\n",(0,l.jsx)(n.h3,{id:"check-controllers",children:"Check Controllers"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"kubectl config use-context kind-kubeflex\r\nkubectl get deployments -n kubeflex-system\r\n# Should show all controllers running\n"})}),"\n",(0,l.jsx)(n.h2,{id:"step-6-create-wecs-workload-execution-clusters",children:"Step 6: Create WECs (Workload Execution Clusters)"}),"\n",(0,l.jsx)(n.p,{children:"Create two clusters that will run your workloads:"}),"\n",(0,l.jsx)(n.h3,{id:"using-kind",children:"Using kind"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"kind create cluster --name cluster1\r\nkind create cluster --name cluster2\r\n\r\nkubectl config rename-context kind-cluster1 cluster1\r\nkubectl config rename-context kind-cluster2 cluster2\n"})}),"\n",(0,l.jsx)(n.h3,{id:"using-k3d",children:"Using k3d"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"k3d cluster create cluster1\r\nk3d cluster create cluster2\r\n\r\nkubectl config rename-context k3d-cluster1 cluster1\r\nkubectl config rename-context k3d-cluster2 cluster2\n"})}),"\n",(0,l.jsx)(n.h2,{id:"step-7-register-wecs-with-its",children:"Step 7: Register WECs with ITS"}),"\n",(0,l.jsx)(n.p,{children:"Register both clusters with your ITS:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Switch to ITS context\r\nkubectl config use-context its1\r\n\r\n# Get registration token\r\nclusteradm get token --context its1 > /tmp/token.yaml\r\n\r\n# Register cluster1\r\nkubectl config use-context cluster1\r\nclusteradm join --hub-token-file /tmp/token.yaml --hub-apiserver $(kubectl config view -o jsonpath='{.clusters[?(@.name==\"its1\")].cluster.server}') --cluster-name cluster1 --context cluster1\r\n\r\n# Register cluster2\r\nkubectl config use-context cluster2\r\nclusteradm join --hub-token-file /tmp/token.yaml --hub-apiserver $(kubectl config view -o jsonpath='{.clusters[?(@.name==\"its1\")].cluster.server}') --cluster-name cluster2 --context cluster2\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Verify registration:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"kubectl config use-context its1\r\nkubectl get managedclusters\r\n# Should show: cluster1 and cluster2\n"})}),"\n",(0,l.jsx)(n.h2,{id:"step-8-label-wecs",children:"Step 8: Label WECs"}),"\n",(0,l.jsx)(n.p,{children:"Label your clusters for targeting with BindingPolicies:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"kubectl config use-context its1\r\n\r\n# Label cluster1 as edge\r\nkubectl label managedcluster cluster1 location-group=edge environment=production\r\n\r\n# Label cluster2 as edge\r\nkubectl label managedcluster cluster2 location-group=edge environment=staging\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Verify labels:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"kubectl get managedclusters --show-labels\n"})}),"\n",(0,l.jsx)(n.h2,{id:"installation-complete-",children:"Installation Complete! \u2705"}),"\n",(0,l.jsx)(n.p,{children:"You now have:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u2705 Hosting cluster running KubeFlex and controllers"}),"\n",(0,l.jsx)(n.li,{children:"\u2705 ITS (its1) managing cluster inventory"}),"\n",(0,l.jsx)(n.li,{children:"\u2705 WDS (wds1) for defining workloads"}),"\n",(0,l.jsx)(n.li,{children:"\u2705 Two WECs (cluster1, cluster2) registered and labeled"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"set-shell-variables-optional",children:"Set Shell Variables (Optional)"}),"\n",(0,l.jsx)(n.p,{children:"For use in example scenarios, set these variables:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'export host_context=kind-kubeflex\r\nexport its_cp=its1\r\nexport its_context=its1\r\nexport wds_cp=wds1\r\nexport wds_context=wds1\r\nexport wec1_name=cluster1\r\nexport wec2_name=cluster2\r\nexport wec1_context=cluster1\r\nexport wec2_context=cluster2\r\nexport label_query_both="location-group=edge"\r\nexport label_query_one="environment=production"\n'})}),"\n",(0,l.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,l.jsx)(n.h3,{id:"helm-chart-installation-fails",children:"Helm Chart Installation Fails"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Check internet connectivity"}),"\n",(0,l.jsxs)(n.li,{children:["Verify Helm can access ghcr.io: ",(0,l.jsx)(n.code,{children:"helm repo add test oci://ghcr.io/kubestellar/kubestellar/core-chart"})]}),"\n",(0,l.jsx)(n.li,{children:"Check Docker is running"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"context-creation-fails",children:"Context Creation Fails"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Ensure you're using the hosting cluster context"}),"\n",(0,l.jsxs)(n.li,{children:["Run ",(0,l.jsx)(n.code,{children:"kflex ctx --set-current-for-hosting"})," first"]}),"\n",(0,l.jsxs)(n.li,{children:["Check KubeFlex pods are running: ",(0,l.jsx)(n.code,{children:"kubectl get pods -n kubeflex-system"})]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"wec-registration-fails",children:"WEC Registration Fails"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Verify network connectivity between WEC and ITS"}),"\n",(0,l.jsxs)(n.li,{children:["Check ITS endpoint is accessible: ",(0,l.jsx)(n.code,{children:"kubectl config view -o jsonpath='{.clusters[?(@.name==\"its1\")].cluster.server}'"})]}),"\n",(0,l.jsx)(n.li,{children:"Ensure OCM agent pods are running on WECs"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,l.jsx)(n.p,{children:"Now that installation is complete:"}),"\n",(0,l.jsxs)(n.p,{children:["\u2192 ",(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.a,{href:"/docs/quickstart/first-deployment",children:"Deploy Your First Application"})})]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},8453(e,n,s){s.d(n,{R:()=>i,x:()=>c});var t=s(6540);const l={},r=t.createContext(l);function i(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);