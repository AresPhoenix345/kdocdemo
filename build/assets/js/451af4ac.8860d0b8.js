"use strict";(globalThis.webpackChunkkubestellar_docs_initiative=globalThis.webpackChunkkubestellar_docs_initiative||[]).push([[1410],{3690(e,n,t){t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"use-cases/helm-charts","title":"Helm Chart Distribution","description":"Problem Statement","source":"@site/docs/use-cases/helm-charts.md","sourceDirName":"use-cases","slug":"/use-cases/helm-charts","permalink":"/docs/use-cases/helm-charts","draft":false,"unlisted":false,"editUrl":"https://github.com/kubestellar/kubestellar/edit/main/kdemo/docs/use-cases/helm-charts.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"CRD Synchronization (Custom Resources Across Clusters)","permalink":"/docs/use-cases/crd-sync"},"next":{"title":"Migration Guides","permalink":"/docs/migration/"}}');var s=t(4848),i=t(8453);const l={},a="Helm Chart Distribution",o={},c=[{value:"Problem Statement",id:"problem-statement",level:2},{value:"Architecture",id:"architecture",level:2},{value:"Implementation Workflow",id:"implementation-workflow",level:2},{value:"Step 1: Decide the distribution approach",id:"step-1-decide-the-distribution-approach",level:3},{value:"Step 2: Apply rendered manifests to WDS",id:"step-2-apply-rendered-manifests-to-wds",level:3},{value:"Step 3: BindingPolicy to distribute the chart",id:"step-3-bindingpolicy-to-distribute-the-chart",level:3},{value:"Step 4: Validate",id:"step-4-validate",level:3},{value:"Recommended Configurations",id:"recommended-configurations",level:2},{value:"BindingPolicy Example",id:"bindingpolicy-example",level:3},{value:"Workload Example",id:"workload-example",level:3},{value:"Expected Outcomes",id:"expected-outcomes",level:2},{value:"Variations and Adaptations",id:"variations-and-adaptations",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"helm-chart-distribution",children:"Helm Chart Distribution"})}),"\n",(0,s.jsx)(n.h2,{id:"problem-statement",children:"Problem Statement"}),"\n",(0,s.jsxs)(n.p,{children:["You need to distribute and manage ",(0,s.jsx)(n.strong,{children:"Helm-based applications"})," consistently across many clusters (dev/stage/prod, regions, edge sites), while keeping values controlled and rollouts safe."]}),"\n",(0,s.jsx)(n.h2,{id:"architecture",children:"Architecture"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"WDS"}),": holds Helm-rendered manifests or a higher-level definition that results in Kubernetes objects"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"ITS"}),": transports those objects to WECs based on labels"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"WECs"}),": run the workloads; differences handled by transforms or controlled value sets"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"implementation-workflow",children:"Implementation Workflow"}),"\n",(0,s.jsx)(n.h3,{id:"step-1-decide-the-distribution-approach",children:"Step 1: Decide the distribution approach"}),"\n",(0,s.jsx)(n.p,{children:"Common patterns:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Render Helm in CI \u2192 apply manifests to WDS"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Deterministic output, GitOps-friendly"}),"\n",(0,s.jsx)(n.li,{children:"KubeStellar syncs native Kubernetes objects"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Helm per cluster group (platform pipeline) + KubeStellar for app resources"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Useful when clusters differ (ingress, storage class)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"This prototype demonstrates (1): render and apply native YAML to WDS, then use BindingPolicy for placement."}),"\n",(0,s.jsx)(n.h3,{id:"step-2-apply-rendered-manifests-to-wds",children:"Step 2: Apply rendered manifests to WDS"}),"\n",(0,s.jsx)(n.p,{children:"Label everything consistently:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: apps/v1\r\nkind: Deployment\r\nmetadata:\r\n  name: mychart-web\r\n  namespace: mychart\r\n  labels:\r\n    app.kubernetes.io/part-of: mychart\r\n    app.kubernetes.io/managed-by: helm\r\nspec:\r\n  replicas: 2\r\n  selector:\r\n    matchLabels:\r\n      app.kubernetes.io/name: mychart-web\r\n  template:\r\n    metadata:\r\n      labels:\r\n        app.kubernetes.io/name: mychart-web\r\n        app.kubernetes.io/part-of: mychart\r\n    spec:\r\n      containers:\r\n      - name: web\r\n        image: nginx:1.25\n"})}),"\n",(0,s.jsx)(n.h3,{id:"step-3-bindingpolicy-to-distribute-the-chart",children:"Step 3: BindingPolicy to distribute the chart"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: control.kubestellar.io/v1alpha1\r\nkind: BindingPolicy\r\nmetadata:\r\n  name: mychart-rollout\r\nspec:\r\n  clusterSelectors:\r\n  - matchLabels:\r\n      environment: staging\r\n  downsync:\r\n  - objectSelectors:\r\n    - matchLabels:\r\n        app.kubernetes.io/part-of: mychart\r\n    resources:\r\n    - namespaces\r\n    - configmaps\r\n    - secrets\r\n    - services\r\n    - deployments\n"})}),"\n",(0,s.jsx)(n.h3,{id:"step-4-validate",children:"Step 4: Validate"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl get deploy -n mychart --context cluster1\r\nkubectl get deploy -n mychart --context cluster2\n"})}),"\n",(0,s.jsx)(n.h2,{id:"recommended-configurations",children:"Recommended Configurations"}),"\n",(0,s.jsx)(n.h3,{id:"bindingpolicy-example",children:"BindingPolicy Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: control.kubestellar.io/v1alpha1\r\nkind: BindingPolicy\r\nmetadata:\r\n  name: mychart-prod\r\nspec:\r\n  clusterSelectors:\r\n  - matchLabels:\r\n      environment: production\r\n  downsync:\r\n  - objectSelectors:\r\n    - matchLabels:\r\n        app.kubernetes.io/part-of: mychart\r\n    resources:\r\n    - namespaces\r\n    - services\r\n    - deployments\n"})}),"\n",(0,s.jsx)(n.h3,{id:"workload-example",children:"Workload Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\r\nkind: Namespace\r\nmetadata:\r\n  name: mychart\r\n  labels:\r\n    app.kubernetes.io/part-of: mychart\n"})}),"\n",(0,s.jsx)(n.h2,{id:"expected-outcomes",children:"Expected Outcomes"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u201cOne chart release\u201d becomes \u201cone workload set\u201d in the WDS"}),"\n",(0,s.jsx)(n.li,{children:"Placement and rollout scope controlled by cluster labels"}),"\n",(0,s.jsx)(n.li,{children:"Consistent multi-cluster deployments without manual context switching"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"variations-and-adaptations",children:"Variations and Adaptations"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Ring-based rollouts (",(0,s.jsx)(n.code,{children:"ring=canary"}),", ",(0,s.jsx)(n.code,{children:"ring=stable"}),")"]}),"\n",(0,s.jsx)(n.li,{children:"Per-cluster-group values (render different manifests per ring/region)"}),"\n",(0,s.jsx)(n.li,{children:"Transforms for ingress/storage annotations"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Conflicts (\u201calready exists\u201d): use dedicated namespaces per release"}),"\n",(0,s.jsx)(n.li,{children:"Divergent cluster capabilities: split chart into common + cloud-specific overlays"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Define a standard \u201cHelm-to-WDS\u201d pipeline template"}),"\n",(0,s.jsx)(n.li,{children:"Add policy-driven promotion: staging \u2192 production by changing labels"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453(e,n,t){t.d(n,{R:()=>l,x:()=>a});var r=t(6540);const s={},i=r.createContext(s);function l(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);